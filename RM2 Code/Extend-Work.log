
  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      Stata 18.0
___/   /   /___/   /   /___/       BE—Basic Edition

 Statistics and Data Science       Copyright 1985-2023 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-782-8272        https://www.stata.com
                                   979-696-4600        service@stata.com

Stata license: Single-user  perpetual
Serial number: 301806304604
  Licensed to: tate
               UGA

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.

. do Extend-Work.do 

. /*********************************
> * Tate Mason                     *
> * UNC Charlotte                  *
> * Extend-Work.do                 *
> *********************************/
. 
. /********************************
> * 1. Environment Setup          *
> ********************************/
.         #delimit cr
delimiter now cr
.         clear

.         clear all

.         set more off

.         cap log close

.         
.         //Data Paths
.         
.   local data "/Volumes/TD1/mason/housing/RM2-Data"

.         local output "/Volumes/TD1/mason/housing/output/"

.         
.         log using `output'/RM2_output.txt, replace
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Volumes/TD1/mason/housing/output//RM2_output.txt
  log type:  smcl
 opened on:  11 Aug 2025, 17:38:09

.         
.         local prepRaw = 1

.         local prepDec = 1

.         local prepDummies = 1

.         local prepDecDummies = 1

.         local gapReg = 1

.         local doGraph = 1

.         local gapGraph = 1

.         local tabReg = 1

.         local bwReg     = 1

.         
. /********************************
> * 2. Data Setup (Percentiles)   *
> ********************************/
.         if `prepRaw' {
.                         
.                         use "`data'/IPUMS-USA_Extension-correct.dta", clear
.                         
.                         keep if inlist(year,1980,1990,2000,2010,2019)
(3,852,728 observations deleted)
.                 
.                         gen rent_inc = 100*rentgrs/(inctot/12) if inctot>0
(12,175,887 missing values generated)
.                         gen hval_inc = valueh/(inctot/12) if inctot>0
(6,410,347 missing values generated)
.                         
.                         
.                         gen inc_month = inctot/12
.                         gen own100 = 100*(1-renter)
.                         
.                         //compute percentiles
.                         local vars "rentgrs valueh own100 inc_month"
.                         
.                         levelsof year, local(years)
1980 1990 2000 2010 2019
.                         
.                         foreach v of local vars {
  2.                                 di "computing percentiles for `v'..."
  3.                                 gen pctr_`v'=.
  4.                                 foreach y of local years {
  5.                                         di "    year=`y'..."
  6.                                         xtile pctr_`v'_`y' = `v' [aw=hhwt] if year==`y', nq(100)
  7.                                         replace pctr_`v'=pctr_`v'_`y' if year==`y'
  8.                                 }
  9.                                 
.                                 
.                         }
computing percentiles for rentgrs...
(17,874,199 missing values generated)
    year=1980...
(1,658,503 real changes made)
    year=1990...
(1,734,259 real changes made)
    year=2000...
(1,607,129 real changes made)
    year=2010...
(339,155 real changes made)
    year=2019...
(359,037 real changes made)
computing percentiles for valueh...
(17,874,199 missing values generated)
    year=1980...
(2,400,882 real changes made)
    year=1990...
(3,716,785 real changes made)
    year=2000...
(3,591,920 real changes made)
    year=2010...
(850,524 real changes made)
    year=2019...
(903,439 real changes made)
computing percentiles for own100...
(17,874,199 missing values generated)
    year=1980...
(4,771,157 real changes made)
    year=1990...
(5,451,044 real changes made)
    year=2000...
(5,199,049 real changes made)
    year=2010...
(1,189,942 real changes made)
    year=2019...
(1,262,476 real changes made)
computing percentiles for inc_month...
(17,874,199 missing values generated)
    year=1980...
(4,771,157 real changes made)
    year=1990...
(5,451,044 real changes made)
    year=2000...
(5,199,049 real changes made)
    year=2010...
(1,189,942 real changes made)
    year=2019...
(1,262,476 real changes made)
.                         save "`data'/fig2data.dta", replace
file /Volumes/TD1/mason/housing/RM2-Data/fig2data.dta saved
.                 }

. /********************************
> * 2. Data Setup (Deciles)       *
> ********************************/
.         if `prepDec' {
.                 
.                 use "`data'/IPUMS-USA_Extension-correct.dta", clear
.                         
.                         keep if inlist(year,1980,1990,2000,2010,2019)
(3,852,728 observations deleted)
.                         
.                         
.                 
.                         gen rent_inc = 100*rentgrs/(inctot/12) if inctot>0
(12,175,887 missing values generated)
.                         gen hval_inc = valueh/(inctot/12) if inctot>0
(6,410,347 missing values generated)
.                         
.                         
.                         gen inc_month = inctot/12
.                         gen own100 = 100*(1-renter)
.                 
.                         //compute deciles       
.                         local vars "rentgrs valueh own100 inc_month"
.                         
.                         levelsof year, local(years)
1980 1990 2000 2010 2019
.                         
.                         foreach v of local vars {
  2.                                 di "computing deciles for `v'..."
  3.                                 gen dec_`v'=.
  4.                                 foreach y of local years {
  5.                                         di "    year=`y'..."
  6.                                         xtile dec_`v'_`y' = `v' [aw=hhwt] if year==`y', nq(10)
  7.                                         replace dec_`v'=dec_`v'_`y' if year==`y'
  8.                                 }
  9.                                 
.                                 
.                         }
computing deciles for rentgrs...
(17,874,199 missing values generated)
    year=1980...
(1,658,503 real changes made)
    year=1990...
(1,734,259 real changes made)
    year=2000...
(1,607,129 real changes made)
    year=2010...
(339,155 real changes made)
    year=2019...
(359,037 real changes made)
computing deciles for valueh...
(17,874,199 missing values generated)
    year=1980...
(2,400,882 real changes made)
    year=1990...
(3,716,785 real changes made)
    year=2000...
(3,591,920 real changes made)
    year=2010...
(850,524 real changes made)
    year=2019...
(903,439 real changes made)
computing deciles for own100...
(17,874,199 missing values generated)
    year=1980...
(4,771,157 real changes made)
    year=1990...
(5,451,044 real changes made)
    year=2000...
(5,199,049 real changes made)
    year=2010...
(1,189,942 real changes made)
    year=2019...
(1,262,476 real changes made)
computing deciles for inc_month...
(17,874,199 missing values generated)
    year=1980...
(4,771,157 real changes made)
    year=1990...
(5,451,044 real changes made)
    year=2000...
(5,199,049 real changes made)
    year=2010...
(1,189,942 real changes made)
    year=2019...
(1,262,476 real changes made)
.                         
.                         
.                         save "`data'/tab1data.dta", replace
file /Volumes/TD1/mason/housing/RM2-Data/tab1data.dta saved
.         }

. /********************************
> * 3. Prep Dummies (Percentiles) *
> ********************************/               
.                 
. if `prepDummies' {
.                 
.                 use "`data'/fig2data.dta", clear
.                 
.                 
.                 local races "asian chinese japanese korean vietnamese filipino indian black"
.                         levelsof pctr_inc_month, local(ps)
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 
> 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100
.                         foreach p of local ps {
  2.                                  
.                                 di "p=`p'"
  3.                                 //generate dummy for income ranks
.                                         gen _incr_p`p' = 0 if pctr_inc_month!=.
  4.                                         replace _incr_p`p' = 1 if pctr_inc_month==`p'
  5.                                 foreach r of local races {
  6.                                         di "race=`r'..."
  7.                                 //generate interaction with race
.                                         gen _ia_`r'_incr_p`p' = `r'*_incr_p`p'
  8.                                 
.                                 
.                                 }
  9.                 
.                         }
p=1
(531 missing values generated)
(175,002 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=2
(531 missing values generated)
(173,672 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=3
(531 missing values generated)
(175,693 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=4
(531 missing values generated)
(181,173 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=5
(531 missing values generated)
(184,938 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=6
(531 missing values generated)
(173,892 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=7
(531 missing values generated)
(175,763 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=8
(531 missing values generated)
(178,554 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=9
(531 missing values generated)
(181,336 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=10
(531 missing values generated)
(174,456 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=11
(531 missing values generated)
(196,810 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=12
(531 missing values generated)
(166,557 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=13
(531 missing values generated)
(180,277 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=14
(531 missing values generated)
(179,353 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=15
(531 missing values generated)
(197,678 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=16
(531 missing values generated)
(161,062 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=17
(531 missing values generated)
(176,127 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=18
(531 missing values generated)
(180,422 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=19
(531 missing values generated)
(175,534 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=20
(531 missing values generated)
(189,332 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=21
(531 missing values generated)
(173,104 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=22
(531 missing values generated)
(191,064 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=23
(531 missing values generated)
(169,358 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=24
(531 missing values generated)
(211,249 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=25
(531 missing values generated)
(145,322 real changes made)
race=asian...
(531 missing values generated)
race=chinese...
(531 missing values generated)
race=japanese...
(531 missing values generated)
race=korean...
(531 missing values generated)
race=vietnamese...
(531 missing values generated)
race=filipino...
(531 missing values generated)
race=indian...
(531 missing values generated)
race=black...
(531 missing values generated)
p=26
