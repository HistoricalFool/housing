
  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      Stata 18.0
___/   /   /___/   /   /___/       BE—Basic Edition

 Statistics and Data Science       Copyright 1985-2023 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-782-8272        https://www.stata.com
                                   979-696-4600        service@stata.com

Stata license: Single-user  perpetual
Serial number: 301806304604
  Licensed to: tate
               UGA

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.

. do Extend-Work.do 

. /*********************************
> * Tate Mason                     *
> * UNC Charlotte                  *
> * Extend-Work.do                 *
> *********************************/
. 
. /********************************
> * 1. Environment Setup          *
> ********************************/
.         #delimit cr
delimiter now cr
.         clear

.         clear all

.         set more off

.         cap log close

.         
.         //Data Paths
.         
.   local data "/Volumes/TD1/mason/housing/RM2-Data"

.         local output "/Volumes/TD1/mason/housing/output/"

.         
.         log using `output'/RM2_output.txt, replace
-----------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Volumes/TD1/mason/housing/output//RM2_output.txt
  log type:  smcl
 opened on:   6 Aug 2025, 13:42:32

.         
.         local prepRaw = 1

.         local prepDec = 1

.         local prepDummies = 1

.         local prepDecDummies = 1

.         local gapReg = 1

.         local doGraph = 1

.         local gapGraph = 1

.         local tabReg = 1

.         local bwReg     = 1

.         
. /********************************
> * 2. Data Setup (Percentiles)   *
> ********************************/
.         if `prepRaw' {
.                         
.                         use "`data'/IPUMS-USA_Extension-correct.dta", clear
.                         
.                         keep if inlist(year,1980,1990,2000,2010,2019)
(21,986,538 observations deleted)
.                 
.                         gen rent_inc = 100*rentgrs/(inctot/12) if inctot>0
(6,063,021 missing values generated)
.                         gen hval_inc = valueh/(inctot/12) if inctot>0
(2,626,669 missing values generated)
.                         
.                         
.                         gen inc_month = inctot/12
.                         gen own100 = 100*(1-renter)
.                         
.                         //compute percentiles
.                         local vars "rentgrs valueh own100 inc_month"
.                         
.                         levelsof year, local(years)
2000 2010 2019
.                         
.                         foreach v of local vars {
  2.                                 di "computing percentiles for `v'..."
  3.                                 gen pctr_`v'=.
  4.                                 foreach y of local years {
  5.                                         di "    year=`y'..."
  6.                                         xtile pctr_`v'_`y' = `v' [aw=hhwt] if year==
> `y', nq(100)
  7.                                         replace pctr_`v'=pctr_`v'_`y' if year==`y'
  8.                                 }
  9.                                 
.                                 
.                         }
computing percentiles for rentgrs...
(8,689,427 missing values generated)
    year=2000...
(1,928,163 real changes made)
    year=2010...
(339,155 real changes made)
    year=2019...
(359,037 real changes made)
computing percentiles for valueh...
(8,689,427 missing values generated)
    year=2000...
(4,308,690 real changes made)
    year=2010...
(850,524 real changes made)
    year=2019...
(903,439 real changes made)
computing percentiles for own100...
(8,689,427 missing values generated)
    year=2000...
(6,236,853 real changes made)
    year=2010...
(1,189,942 real changes made)
    year=2019...
(1,262,476 real changes made)
computing percentiles for inc_month...
(8,689,427 missing values generated)
    year=2000...
(6,236,853 real changes made)
    year=2010...
(1,189,942 real changes made)
    year=2019...
(1,262,476 real changes made)
.                         
.                 
.                         
.                         save "`data'/fig2data.dta", replace
